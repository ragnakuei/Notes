# 範例 01


```cs
// 此頁面 Url
@page "/Login"

@addTagHelper*, Microsoft.AspNetCore.Mvc.TagHelpers

// 指向 Code Behind 的 Class
@model BlazorServer.Pages.Login

@{
    Layout = null;
}

<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link rel="stylesheet"
          href="~/lib/bootstrap/5.1.3/css/bootstrap.min.css" />
    <style>
        .center-block {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
      </style>
</head>
<body>

<div class="container center-block">

    <form method="post"
          autocomplete='off'>
        <div class="mb-3 row">
            <div class="col-12 text-start col-sm-5 text-sm-end">
                <label asp-for="Dto.Account"
                       class="col-form-label">
                </label>
            </div>
            <div class="col-12 col-sm-2">
                <input type="text"
                       required
                       class="form-control"
                       asp-for="Dto.Account">
            </div>
            <div class="col-12 col-sm-5"></div>
        </div>

        <div class="mb-3 row">
            <div class="col-12 text-start col-sm-5 text-sm-end">
                <label asp-for="Dto.Password"
                       class="col-form-label">
                </label>
            </div>
            <div class="col-12 col-sm-2">
                <input type="password"
                       required
                       class="form-control"
                       asp-for="Dto.Password">
            </div>
            <div class="col-12 col-sm-5"></div>
        </div>

        <div class="mb-3 d-flex justify-content-center">
            <input type="submit"
                   class="btn btn-primary"
                   value="登入" />
        </div>
    </form>

</div>

<script src="~/lib/bootstrap/5.1.3/js/bootstrap.min.js"></script>
</body>
</html>

```


```cs
using System.Security.Claims;
using BusinessLogicLayer.Account;
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using SharedLibrary.Models;
using SharedLibrary.Models.Account;
using SharedLibrary.Web;
using SharedLibrary.Web.Parameters;

namespace BlazorServer.Pages;

public class Login : PageModel
{
    private readonly IAccountService     _accountService;
    private readonly IMemoryCacheService _memoryCacheService;

    public Login(IAccountService     accountService,
                 IMemoryCacheService memoryCacheService)
    {
        _accountService     = accountService;
        _memoryCacheService = memoryCacheService;
    }

    [BindProperty]
    public LoginFormDto Dto { get; set; }

    public void OnGet()
    {
    }

    public async Task<IActionResult> OnPost()
    {
        var userInfoDto = _accountService.Login(Dto);

        await LoginAsync(userInfoDto);

        return Redirect("/");
    }

    private async Task LoginAsync(UserInfoDto userInfoDto)
    {
        var claims = new List<Claim>
                     {
                         new Claim(CustomClaimTypeConst.UserGuid, userInfoDto.Guid.ToString()),
                         new Claim(ClaimTypes.Role,               userInfoDto.Role)
                     };

        var claimsIdentity = new ClaimsIdentity(claims, CookieSchema.Authentication);

        await HttpContext.SignInAsync(CookieSchema.Authentication, new ClaimsPrincipal(claimsIdentity));

        _memoryCacheService.Set(userInfoDto.Guid.ToString(), userInfoDto, TimeSpan.FromDays(1));
    }
}
```