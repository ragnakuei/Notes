# 注意事項

1. js / css 的引用要用 ~/ 開頭 !

    ```html
    <link rel="stylesheet" href="~/lib/bootstrap/5.1.3/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    ```

1. IActionResult 的 Redirect() 都吃不到 virtual directory 的資訊，所以要用 ~/ 開頭 !

    ```
    例：要去 TestController 中的 Index() Action
    要用 Redirect("~/test/index") 而不能用 Redirect("/test/index")
    ```

1. 其餘在 cshtml 中，全部 ( 包含 js script 內 ) 都要以 @(Url.Content("~/URL")) 來給定其 URL

    ```html
    <a href='@(Url.Content("~/Test/Index"))'>To Test/Index</a>
    ```

1. Program.cs 中，下面的語法，不需要做調整 !

    ```cs
    app.UseExceptionHandler("/Home/Error");
    ```
1. 可以從 context.Request.PathBase 取得 virtual directory !

    MvcException Middleware 範例：

    ```cs
    public class MvcExceptionMiddleware
    {
        public MvcExceptionMiddleware(RequestDelegate                 next,
                                      ILogger<MvcExceptionMiddleware> logger)
        {
            _logger = logger;
            _next   = next;
        }

        private readonly ILogger<MvcExceptionMiddleware> _logger;

        private readonly RequestDelegate _next;

        public async Task InvokeAsync(HttpContext context)
        {
            try
            {
                await _next(context);
            }
            catch (Exception ex)
            {
                context.Response.StatusCode = (int)HttpStatusCode.Redirect;

                var virtualDirectory = context.Request.PathBase;
                var code             = (int)HttpStatusCode.InternalServerError;
                var url              = $"{virtualDirectory}/StatusCode?code={code}";
                context.Response.Redirect(url, false);
            }
        }
    }
    ```