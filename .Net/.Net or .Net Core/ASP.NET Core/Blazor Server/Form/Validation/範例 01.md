# 範例 01

- 自訂驗証做法
  - EditForm 要指定 EditContext，不使用 Model
    - EditContext 綁定驗証事件 OnValidationRequested
    - 可用該事件做自訂驗証
- 錯誤訊息的承接物件為 ValidationMessageStore
- ValidationSummary 顯示所有的錯誤訊息
- ValidationMessage 顯示個別欄位的錯誤訊息
  - 每個欄位的錯誤訊息都會被顯示在個別的 div 中
- Dispose 解除驗証事件綁定
  

```html
@page "/form-example-2"
@implements IDisposable
@using System.ComponentModel.DataAnnotations

<EditForm EditContext="@editContext"
          OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <p>
        <label>
            Identifier:
            <InputText @bind-Value="starship.Identifier" />
        </label>
        <label>
            <ValidationMessage For="@(() => starship.Identifier)" />
        </label>
    </p>

    <p>
        <label>
            TestDate:
            <InputDate @bind-Value="starship.TestDate" />
        </label>
        <label>
            <ValidationMessage For="@(() => starship.TestDate)" />
        </label>
    </p>


    <button type="submit">Submit</button>

    <p>
        <a href="http://www.startrek.com/">Star Trek</a>,
        &copy;1966-2019 CBS Studios, Inc. and
        <a href="https://www.paramount.com">Paramount Pictures</a>
    </p>
</EditForm>

@code {
    private EditContext? editContext;
    private Starship starship = new() { };
    private ValidationMessageStore? messageStore;

    protected override void OnInitialized()
    {
        editContext = new(starship);
        editContext.OnValidationRequested += HandleValidationRequested;
        messageStore = new(editContext);
    }

    private void HandleValidationRequested(object? sender,
        ValidationRequestedEventArgs args)
    {
        messageStore?.Clear();

        // 自訂驗証邏輯
        if (starship.TestDate == null)
        {
            messageStore?.Add(() => starship.TestDate, "Please Input TestDate.");
        }
    }

    private void HandleValidSubmit()
    {
        if (editContext != null && editContext.Validate())
        {
            // Form is valid !

            return;
        }

        // Form is invalid !
    }

    public void Dispose()
    {
        if (editContext is not null)
        {
            editContext.OnValidationRequested -= HandleValidationRequested;
        }
    }

    public class Starship
    {
        [Required]
        [StringLength(16, MinimumLength = 3, ErrorMessage = "Identifier length between 3 and 16")]
        public string? Identifier { get; set; }

        public string? Description { get; set; }

        public DateOnly? TestDate { get; set; }
    }
}
```